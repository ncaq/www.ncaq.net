---
title: commitlintã‚’æ‹¡å¼µã—ã¦è‡ªå‰ã®ãƒ«ãƒ¼ãƒ«ã‚’çµ„ã¿è¾¼ã‚“ã§ã‚ã‚ŠãŒã¡ãªã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ãƒŸã‚¹ã‚’é˜²ã
---

ä»Šæ—¥ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°ã‚’è¦‹è¿”ã—ã¦ã„ãŸã‚‰å¥ç‚¹ã§çµ‚ã‚ã‚‹ã‚µãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚³ãƒŸãƒƒãƒˆãƒ­ã‚°ã‚’è¦‹ã¤ã‘ã¦ã—ã¾ã„ã¾ã—ãŸã€‚
[fix: `web-mode-comment-indent-new-line`ã‚’ä¸€æ™‚çš„ã«ç„¡åŠ¹åŒ–ã€‚ Â· ncaq/.emacs.d@47b2384](https://github.com/ncaq/.emacs.d/commit/47b2384720f50b7bc71d2666ddda6301709d5b67)

ä¸€è¡Œç›®ã®ã‚µãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯å¥ç‚¹ç„¡ã—ã§çµ±ä¸€ã—ãŸã„ã§ã™ã€‚
å°‘ãªãã¨ã‚‚è‹±èªã‚³ãƒŸãƒƒãƒˆã«ãŠã„ã¦ã¯`.`ã¯ç„¡ã—ã§çµ±ä¸€ã—ã¦ã„ã‚‹ã®ã§ã©ã¡ã‚‰ã‹ã«ã¯å¯„ã›ãŸã„ã§ã™ã­ã€‚

# subject-full-stopã¯1æ–‡å­—é™å®š

æ—¢ã«ä½¿ã£ã¦ã„ã‚‹ã€
[conventional-changelog/commitlint: ğŸ““ Lint commit messages](https://github.com/conventional-changelog/commitlint)
ã«ã¯ã€
[subject-full-stop](https://github.com/conventional-changelog/commitlint/blob/2ebcdfd0eb8dcda6b8b531d8b83b724b82a5163d/%40commitlint/config-conventional/README.md#subject-full-stop)
ã¨ã„ã†ãƒ«ãƒ¼ãƒ«ãŒã‚ã‚Šã€
`.`ã§çµ‚ã‚ã‚‹ã‚µãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯`@commitlint/config-conventional`ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã§ç¦æ­¢ã•ã‚Œã¦ã„ã¾ã™ã€‚

ã—ã‹ã—`subject-full-stop`ãŒå–ã‚Œã‚‹å€¤ã¯è¦‹ã¦ã®é€šã‚Šä¸€ã¤ã®æ–‡å­—é™å®šã§ã€
è¤‡æ•°ã®æ–‡å­—ã‚’ä¸è¨±å¯ã«ã—ãŸã‚Šæ­£è¦è¡¨ç¾ã§ç¦æ­¢ã—ãŸã‚Šå‡ºæ¥ã¾ã›ã‚“ã€‚

ã‚ˆã£ã¦æ‹¡å¼µãƒ«ãƒ¼ãƒ«ã‚’æ›¸ãã“ã¨ã«ã—ã¾ã—ãŸã€‚
ã™ãçµ‚ã‚ã‚‹ã‹ã¨æ€ã£ãŸã®ã§ã™ãŒã€
æ¡ˆå¤–æ™‚é–“ãŒã‹ã‹ã£ãŸã®ã§ã“ã“ã«è¨˜ã—ã¦ãŠãã¾ã™ã€‚

# ãƒ«ãƒ¼ãƒ«ã®è¨˜è¿°

ã“ã‚Œã¯`subject-full-stop`ã‚’å‚è€ƒã«ã€
ãƒãƒƒãƒãƒ³ã‚°ã‚’Unicodeæ–‡å­—é›†åˆãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å‚ç…§ã™ã‚‹ã‚ˆã†ã«æ”¹é€ ã™ã‚‹ã“ã¨ã§ä¸€ç¬ã§å®Ÿè£…ã¯çµ‚ã‚ã‚Šã¾ã—ãŸã€‚

~~~ts
import message from "@commitlint/message";
import type { SyncRule } from "@commitlint/types";

/**
 * `subject-full-stop`ã®æ‹¡å¼µã€‚
 * æ—¥æœ¬èªã®å¥èª­ç‚¹ã‚‚å«ã‚ã¦åˆ¶å¾¡ã™ã‚‹ã€‚
 * å¥èª­ç‚¹ãªã©è¨˜å·ã¯ç„¡ã—ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã€‚
 */
export const subjectAlnumStop: SyncRule<RegExp | undefined> = (
  parsed,
  when = "always",
  value = /[^\p{Letter}\p{Number}]/u
) => {
  let colonIndex = parsed.header.indexOf(":");
  if (colonIndex > 0 && colonIndex === parsed.header.length - 1) {
    return [true];
  }

  const input = parsed.header;

  const negated = when === "never";
  const hasStop = value.test(input[input.length - 1]);

  return [negated ? !hasStop : hasStop, message(["subject", negated ? "may not" : "must", "end with alnum stop"])];
};
~~~

å¥èª­ç‚¹ä»¥å¤–ã«ã‚‚è‰²ã€…BANã—ã¦ã¾ã™ã€‚
ã‚µãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æœ€å¾Œã«ã¯æ™®é€šã«èª­ã‚ã‚‹æ–‡å­—ä»¥å¤–å…¥ã‚ŒãŸããªã„ã®ã§ã¾ã¨ã‚ã¦æ’é™¤ã€‚

# ãƒ«ãƒ¼ãƒ«ã®çµ„ã¿è¾¼ã¿

ã“ã“ãŒçµæ§‹è‹¦æˆ¦ã—ã¾ã—ãŸã€‚
commitlintã¯é€”ä¸­ã‹ã‚‰TypeScriptã«ã—ãŸã‹ã‚‰ã‹ã€
æ§‹é€ ãŒåˆ†ã‹ã‚Šé›£ã‹ã£ãŸã‚Šã€
JavaScriptå‰æã®è¨˜è¿°ãŒçµæ§‹ã‚ã£ãŸã‚Šã—ã¦ã€
å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«æƒ‘ã‚ã•ã‚Œã¾ã—ãŸã€‚

[commitlint/concepts-shareable-config.md at master Â· conventional-changelog/commitlint](https://github.com/conventional-changelog/commitlint/blob/master/docs/concepts-shareable-config.md)
ã¯å‚è€ƒã«ã—ãªã„ã»ã†ãŒè‰¯ã„ã§ã™ã€‚
ã“ã‚Œã®ã›ã„ã§ä¸€åº¦TypeScriptã‚’JavaScriptã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦`extends`ã«å…¥ã‚Œã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã‹ã¨ã‹ã‹ãªã‚Šè¿·ã„ã¾ã—ãŸã€‚
å®Ÿéš›ã¯`ts-node`ã§å®Ÿè¡Œã•ã‚Œã‚‹ã®ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«å¿…è¦ãªã„ã§ã™ã€‚
ã‚€ã—ã‚ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ··ä¹±ã•ã›ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

[commitlint/reference-plugins.md at master Â· conventional-changelog/commitlint](https://github.com/conventional-changelog/commitlint/blob/master/docs/reference-plugins.md)
ã‚’å‚è€ƒã«pluginã¨ã—ã¦ç”Ÿæˆã—ãŸã»ã†ãŒè‰¯ã„ã§ã—ã‚‡ã†ã€‚

ãŸã ã“ã‚Œã¯JavaScriptå‰æã®è¨˜è¿°ãªã®ã§ã€
TypeScriptã§è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›¸ã„ã¦é–“é•ã£ãŸè¨˜è¿°ã‚’ã—ãŸããªã„ãªã‚‰ã°ã€
[commitlint/reference-configuration.md at master Â· conventional-changelog/commitlint](https://github.com/conventional-changelog/commitlint/blob/master/docs/reference-configuration.md)
ã‚’ãƒ™ãƒ¼ã‚¹ã«æ›¸ã„ã¦ã€
ã“ã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ã«è¼‰ã£ã¦ãªã„`UserConfig`ã®`plugins`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å®Ÿè£…ã—ã¦ã„ãã“ã¨ã«ãªã‚Šã¾ã™ã€‚

~~~ts
import { RuleConfig, RuleConfigQuality, Plugin } from "@commitlint/types";
import { subjectAlnumStop } from "./subject-alnum-stop";

export const plugin: Plugin = {
  rules: {
    "subject-alnum-stop": subjectAlnumStop,
  },
};

export type RulesConfig<V = RuleConfigQuality.User> = {
  "subject-alnum-stop": RuleConfig<V, RegExp | undefined>;
};
~~~

ã®ã‚ˆã†ã«å‹ã‚’æ˜ç¤ºã—ãªãŒã‚‰`Plugin`ã‚’ä½œã‚Šã¾ã™ã€‚

~~~ts
/* eslint-disable import/no-import-module-exports */
import type { UserConfig } from "@commitlint/types";
import { RuleConfigSeverity } from "@commitlint/types";
import { plugin as userPlugin } from "./src/@commitlint/rules/index";

const Configuration: UserConfig = {
  extends: ["@commitlint/config-conventional"],
  rules: {
    // æ—¥æœ¬èªãªã©ã‚‚å«ã‚ãŸå¯èª­æ–‡å­—ã§çµ‚ã‚ã‚‹ã“ã¨ã‚’æ±‚ã‚ã‚‹ã€‚
    "subject-alnum-stop": [RuleConfigSeverity.Error, "never"],

    // URLã‚„Markdownã®ãƒªãƒ³ã‚¯ãªã©æ”¹è¡Œå‡ºæ¥ãªã„è¦ç´ ãŒé »ç¹ã«é »ç¹ã«å‡ºç¾ã™ã‚‹ãŸã‚ç·©ã‚ã‚‹ã€‚
    "body-max-line-length": [RuleConfigSeverity.Disabled],
    "footer-max-line-length": [RuleConfigSeverity.Disabled],
    // é–¢æ•°ãªã©ã®è­˜åˆ¥å­ãªã©ã‚’ç›´æ¥ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚¿ã‚¤ãƒˆãƒ«ã«æ›¸ããŸã„ã®ã§ç„¡åŠ¹ã«ã™ã‚‹ã€‚
    "subject-case": [RuleConfigSeverity.Disabled],
  },
  plugins: [userPlugin],
};

module.exports = Configuration;
~~~

ã®ã‚ˆã†ã«`plugins`ã«çµ„ã¿è¾¼ã¿ã¤ã¤`rules`ã‚’æ›¸ã‘ã°å®Œæˆã§ã™ã€‚

# å‹ãƒã‚§ãƒƒã‚¯ã‚‚ã¡ã‚ƒã‚“ã¨ã‚„ã‚ŠãŸã„

å‹ãƒã‚§ãƒƒã‚¯ã§`subject-alnum-stop`ãƒ«ãƒ¼ãƒ«ã®`value`ã«`RegExp`ã§ã¯ãªã`number`ã‚’æ¸¡ã—ãŸã‚Šã—ãŸã‚‰ç·¨é›†ã—ã¦ã‚‹æ™‚ã«ã‚¨ãƒ©ãƒ¼ã‚’å‡ºã—ãŸã„ã§ã™ã‚ˆã­ã€‚

è‡ªåˆ†ã§æ›¸ã„ãŸãƒ«ãƒ¼ãƒ«ãªã®ã§ã‚‚ã†æŠŠæ¡ã—ã¦ã‚‹ã®ã§è‡ªåˆ†ã®åˆ†ã ã‘ã¯å¤šåˆ†å•é¡Œãªã„ã‚“ã§ã™ãŒã€
ã‚‚ã—npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦å…¬é–‹ã™ã‚‹å ´åˆã«ã¯ã¡ã‚ƒã‚“ã¨ã‚„ã‚ŠãŸã„ã€‚

äº¤å·®å‹ä½¿ã£ã¦ã¡ã‚ƒã‚“ã¨ã‚„ã‚Šã¾ã—ãŸã€‚
ã¡ã‚ƒã‚“ã¨ã‚¨ãƒ©ãƒ¼å‡ºã¾ã™ã€‚

~~~ts
/* eslint-disable import/no-import-module-exports */
import type { RulesConfig, UserConfig } from "@commitlint/types";
import { RuleConfigSeverity } from "@commitlint/types";
import { plugin as userPlugin, RulesConfig as UserRulesConfig } from "./src/@commitlint/rules/index";

const rules: Partial<RulesConfig & UserRulesConfig> = {
  // æ—¥æœ¬èªãªã©ã‚‚å«ã‚ãŸå¯èª­æ–‡å­—ã§çµ‚ã‚ã‚‹ã“ã¨ã‚’æ±‚ã‚ã‚‹ã€‚
  "subject-alnum-stop": [RuleConfigSeverity.Error, "never"],

  // URLã‚„Markdownã®ãƒªãƒ³ã‚¯ãªã©æ”¹è¡Œå‡ºæ¥ãªã„è¦ç´ ãŒé »ç¹ã«é »ç¹ã«å‡ºç¾ã™ã‚‹ãŸã‚ç·©ã‚ã‚‹ã€‚
  "body-max-line-length": [RuleConfigSeverity.Disabled],
  "footer-max-line-length": [RuleConfigSeverity.Disabled],
  // é–¢æ•°ãªã©ã®è­˜åˆ¥å­ãªã©ã‚’ç›´æ¥ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚¿ã‚¤ãƒˆãƒ«ã«æ›¸ããŸã„ã®ã§ç„¡åŠ¹ã«ã™ã‚‹ã€‚
  "subject-case": [RuleConfigSeverity.Disabled],
};

const Configuration: UserConfig = {
  extends: ["@commitlint/config-conventional"],
  rules,
  plugins: [userPlugin],
};

module.exports = Configuration;
~~~

æœ¬å½“ã¯è¨­å®šã‚’çµ„ã¿è¾¼ã‚€å´ãŒæ°—ã‚’ã¤ã‘ãªã„ã§ã‚‚è‡ªå‹•çš„ã«å‹ãƒã‚§ãƒƒã‚¯ãŒå…¥ã£ã¦æ¬²ã—ã„ã®ã§ã™ãŒã€
æ–¹æ³•ãŒã‚¤ãƒã‚¤ãƒåˆ†ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚

ã¨ã“ã‚ã§`ts-node`ã‚’ä½¿ã£ã¦`import`ã‚’ä½¿ã£ã¦ã„ã‚‹ã®ã«ã€
ESMå½¢å¼ã®`default export`ã‚’ä½¿ã£ãŸã‚‰ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã‚“ã§ã™ã‚ˆã­ã€‚
ã“ã‚Œã¯ts-nodeã®å•é¡Œã‚‰ã—ã„ã§ã™ã€‚

* [ERR_REQUIRE_ESM when using Node.js ESM in tandem with TypeScript config (commitlint.config.ts) Â· Issue #3251 Â· conventional-changelog/commitlint](https://github.com/conventional-changelog/commitlint/issues/3251)
* [ESM support: soliciting feedback Â· Issue #1007 Â· TypeStrong/ts-node](https://github.com/TypeStrong/ts-node/issues/1007)

æ·±åˆ»ãªãƒŸã‚¹ã«ç¹‹ãŒã‚‹ã‚ˆã†ãªè­¦å‘Šã§ã¯ãªã„ã®ã§ã²ã¨ã¾ãšæ”¾ç½®ã—ã¾ã™ã€‚
